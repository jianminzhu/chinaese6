<script src="/js/jquery-3.3.1.min.js"></script>
<script src="/js/tolang.js?v=1.11"></script>
{include file="../application/index/view/index/_commoncss.html" /}
<script>
    function search() {
        let $form = $('form[name="searchForm"]');
        let $bsearch = $form.find("[name=b_search]");
        $("body").delegate("[data-page]", "click", function () {
            let clickPage = $(this).data("page");
            if (clickPage != $form.find("[name=pno]").val()) {
                $form.find("[name=pno]").val(clickPage);
                $bsearch.trigger("click");
            }
        });
        $("body").delegate("[data-opt-delpics]", "click", function () {
            let mid = $(this).data("mid") || ""
            let picid = $(this).data("picid") || ""
            let url = `/index.php/admin/page/manager/delpics?mid=${mid}&picid=${picid}`
            $.ajax(url).then(function () {
                $("#bigimg").hide();
            })
        })
        $("body").delegate("[data-opt-bigimg]", "mouseover", function () {
            let picid = $(this).data("picid");
            let mid = $(this).data("mid");
            let imgsrc = $(this).attr("data-opt-bigimg")
            let html = `<div style="display: flex;position: fixed;left:5%;top:5%;width: 300px;height: 300px;">
<table  style="background-color: #FFF; "><thead style="background-color: #7a869d">
<th align="left"><button data-opt-delpics data-mid=${mid} data-picid=${picid} style="color: red"> 删除图片</button></th>
<th style="text-align: right"><button href="javascript:void(0)"  onclick="$('#bigimg').hide()">X</button></th>
</thead>
<tr><td  colspan="2"><div class="profile-bg" style="background-image:url('${imgsrc}'); width: 400px;height: 400px;"></div>  </td></tr>
</table></div>`;

            $("#bigimg").html(html)
            $("#bigimg").css({"display": "flex"}).show();
            $("#bigimg").show();
        })
        $("select").on("change", function () {
            $("input[name=pno]").val(1)
        })
        $bsearch.on("click", function () {
            $form.trigger("click");
        })
        $form.on("submit", function () {
            let $searchResults = $("[name=searchResults]");
            $searchResults.html("加载中...")
            $.ajax({
                url: "/index.php/index/base/searchAdmin?" + $form.serialize(),
                dataType: "html"
            }).then(function (html) {
                $searchResults.html(html)
            });
            return false;
        })
        return $form;
    }

    $(function () {
        search().trigger("submit");
    })
</script>

<div class="max-width mx-auto mt0 ">
<form name="searchForm" id="searchForm">
    <div class="search mt2 p2  mx-auto shadow rounded flex flex-wrap items-center justify-between max-width">
        <div class="border-bottom m1 col-2">
            <label for="form-quick-search-seeking">{:lang('寻找')}</label>
            <input style="display: none;" name="pno"   value="1"/>
            <input style="display: none;" name="pics" value="y" >
            <input type="text" style="width:10px  " value="30" name="__psize">
            <select name="sex" id="form-quick-search-seeking" class="col-12">
                <option value="-1">{:lang("不限")}</option>
                <option value="1">{:lang("男性")}</option>
                <option value="0" selected="">{:lang("女性")}</option>
            </select>
        </div>

        <div class="border-bottom search-age m1">
            <label for="form-quick-search-age-min">{:lang("年龄")}</label>
            <div class="flex items-center">


                <select name="age_min" id="form-quick-search-age-min" class="col-12">
                    <option value="-1">-</option>
                    <option value="18" selected="">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                    <option value="32">32</option>
                    <option value="33">33</option>
                    <option value="34">34</option>
                    <option value="35">35</option>
                    <option value="36">36</option>
                    <option value="37">37</option>
                    <option value="38">38</option>
                    <option value="39">39</option>
                    <option value="40">40</option>

                </select>


                <select name="age_max" id="form-quick-search-age-max" class="col-12">
                    <option value="-1">-</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                    <option value="32">32</option>
                    <option value="33">33</option>
                    <option value="34">34</option>
                    <option value="35">35</option>
                    <option value="36">36</option>
                    <option value="37">37</option>
                    <option value="38" selected="">38</option>
                    <option value="39">39</option>
                    <option value="40">40</option>
                </select>
            </div>
        </div>


        <div class="border-bottom m1 col-2">
            <label for="form-quick-search-country">{:lang("国家")}</label>
            {include file="../application/index/view/index/_select_country.html" /}
        </div>

        <div class="border-bottom m1 col-2">
            <label for="form-quick-search-state">{:lang('省/县')}</label>
            <select name="stateid" id="form-quick-search-state" class="col-12" data-dependentselect="cityLive"
                    formaction="/zc/widget/loadstates?countryid="
                    data-datamap="{&quot;group&quot;:&quot;STATEVALUE&quot;,&quot;text&quot;:&quot;TRANSLATION&quot;,&quot;value&quot;:&quot;ATTRIBUTEID&quot;}">
                <option value="-1">{:lang("任何")}</option>
            </select>
        </div>

        <div class="border-bottom m1 col-2">
            <label for="form-quick-search-city">{:lang('市')}</label>
            <select name="cityid" id="form-quick-search-city" class="col-12"
                    formaction="/zc/widget/loadcities?stateid="
                    data-datamap="{&quot;group&quot;:&quot;STATEVALUE&quot;,&quot;text&quot;:&quot;TRANSLATION&quot;,&quot;value&quot;:&quot;ATTRIBUTEID&quot;}">
                <option value="-1">{:lang("任何")}</option>
            </select>
        </div>
        <button name="b_search" class="h4 py1 px2 rounded shadow border-none upper-case pointer">{:lang("搜索")}
        </button>
    </div>
</form>
</div>
<div id=bigimg ></div>
<div name="searchResults">
</div>